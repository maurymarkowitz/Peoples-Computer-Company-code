5 Y=2999:IN."DO YOU WANT A DIFFICULT GAME?","(Y OR N)";A
10 P."STARDATE 3200: YOUR MISSION IS ",J:IFA=YY=999
15 K=8,D=30:I=1:IF(U(63)+J-K,K-99)<5:B=B+J
20 M=(X)+(Y)+(M<249)+(M<99)+(M<4)+(M<2)+(M<9)+(M<2),K=K+M
25 F(1)=-100:M-10*J-R(B):IN.IF(B<2)+(K>4)G=15
30 P."TO DESTROY ",I," KLINGONS IN 30 STARDATES."
35 P."THERE ARE ",I,B," STARBASES.":GOS.160:C=6,H=K
40 U=R(6),V=R(8),X=R(8),Y=R(8)
45 F=1:IF(10152)=(140):IN.IF(8+X+Y+62)=4,M=A*((B+U-9)),N=M/100
50 I=1:IFN=J:TONGOS.165:IF(J+134)=3:I=1:IF(J+140)=5,B(J+146)=T:IN.J
55 GOS.175:M=M-100*N:I=2:IFM/10GOS.165
60 M=M-M/10*10:I=3:IFM/J=1:TOM/10GOS.165:N.J
65 GOS.145:GOS.325:IFK<95
70 P.JP."MISSION ACCOMPLISHED.":IFD<3P."BOY, YOU BARELY MADE IT."
75 IFD>5P."GOOD WORK...":IFD>9P."FANTASTIC!":IFD>13P."UNBELIEVABLE!"
80 D=30-D:I=H*100/D:I=1:P.I,H," KLINGONS IN ",D," STARDATES. (",I," )"
85 J=100*(C<8)-5:C=C+1:P.I,C," CASUALTIES INCURRED. (",J," )"
90 P."YOUR SCORE:",I+J:G.110
95 IFD>K:P."IT'S TOO LATE. THE FEDERATION HAS BEEN CONQUERED.":G.110
100 IFE=0:G.120
105 P."ENTERPRISE DESTROYED":IFH-K>9:P."BUT YOU WERE A GOOD MAN
110 Y=987:I:P.J:IN."ANOTHER GAME?","(Y OR N)":A:IFA=Y:G.5
115 P."GOOD BYE.":STOP
120 S=220,G=160,L=200,P=260,R=420,W=465,T=555:IN."CAPT. IN";A
125 IF(A=S)+(A=G)+(A=L)+(A=P)+(A=R)+(A=W)+(A=T):G.A
130 P."K=REPORT S=SR. SENSOR L=LR. SENSOR
135 P."G=GALAXY MAP P=PHASER T=TORPEDO
140 P."W=WARP ENGINE PLEASE USE ONE OF THESE COMMANDS":G.120
145 F.I=X-(X<1)TOX+(X<8):F.J=Y-(Y<1)TOY+(Y<8)
150 IF(8*I+J+62)#2:N.J:IN.110:D=0:R.
155 IFD=0P."SULU: CAPTAIN, WE ARE DOCKED AT STARBASE."
160 E=4000,F=10,D=1:IF.I=64TO70:I@(I)=0:N.J:R.
165 SR=R(8),T=R(8),A=8*I+J+62:IF(A<6):G.165
170 @(A)=1:K.
175 P."ENTERPRISE IN U-",I,U,V," S-",X,Y:R.
180 GOS.175:J=2:GOS.375:IFI:G.120
185 P." OF GALAXY MAP":F.I=B(1+J):P.JP." ",I,I," ",J:IF.J=0TO7:M=@(8*I+J)
190 P." ",IFM>0:M:IN.J:P.IN.L:P." ",I:IF.J=10TO7:P." ",I:N.J:P.
195 P." ",I:F.I=1TO8:JP." ",I:N.J:P.:G.120
200 GOS.175:J=3:GOS.375:IFI:G.120
205 P.:F.I=U-1TOU+1:F.J=V-1TOV+1:M=@(8*I+J-9):A=0
210 IF(I<0)+(I>9)+(J<0)+(J>9):A=A+@(M):@(M)=A
215 P.I,A:IN.J:P.IN.:G.120
220 GOS.175:J=1:GOS.375:IFI:G.120
225 M=@(8*U+V-9):M=A+@(M)
230 P.:F.J=1TO8:I=@(8*I+J+62):IFM=0:P.".",
235 IFM=1:P."K",
240 IFM=2:P."G",
245 IFM=3:P." ",
250 IFM=4:P."E",
255 N.J:P.IN.:P." ",I:F.I=1TO8:P."2",I:N.I:P.:G.120
260 J=4:GOS.375:IFI:G.120
265 IN."ENERGIZED.","UNITS TO FIRE";A:IFA<1G.120
270 IFA>EP.SPOCK: "WE HAVE ONLY ",E," UNITS.":G.120
275 E-E-A:IFN:IP."PHASER FIRED AT EMPTY SPACE.":G.65
280 A-A/N:IF.M=135TO140:IF@(M)=0:G.290
285 GOS.295:P."3",S," UNITS HIT ":GOS.305
290 N.M:G.65
295 IFA=1098:P."...OVERLOADED...":J=4:@(67)=1:A=9:GOS.375
300 I=(M+6)-X,J=(M+12)-Y:S=A30/(30+(II)+(JJ)):R.
305 P."KLINGON AT S-",I,(M+6),(M+12),10@(M)=@(M)-S
310 IF@(M)<0:P."DAMAGED":R.
315 @(64)=@(M+6):@(70)=@(M+12):@(8U+V+62)=@(1):@(1)=@(1)-100:J=X-K-1
320 I=64:@(M+6)+@(M+12)+62:@(1)=B:N=N-1:JP."DESTROYED":R.
325 IFN=0:K.
330 P."KLINGON ATTACK":IFOP."STARBASE PROTECTS ENTERPRISE":R.
335 T=0:IF.M=135TO140:IF@(M)=0:G.350
340 A=(@(M)+H*@(M))/2:GOS.295:T=T+S:I=(M+6):J=(M+12)
345 P."3",S," UNITS HIT FROM KLINGON AT S-",I,J
350 N=N-1:E=E-T:IFUP."*** BANG ":R.
355 P.I,E," UNITS OF ENERGY LEFT.":IFR(E/4)>T:R.
360 IF@(70)=1:@(70)=K(T/50+1):J=7:G.375
365 J=H:@(64):@(J+63)=R(T/99+1)+@(J+63)1:K=R(8)+1:C=C+1
370 P."MC COY: "SICKBAY TO BRIDGE, WE SUFFERED ",2I," CASUALTIES."
375 I=@(J+63):IFJ=1P."SHORT RANGE SENSOR",
380 IFJ=2P."COMPUTER DISPLAY",
385 IFJ=3P."LONG RANGE SENSOR",
390 IFJ=4P."PHASER",
395 IFJ=5P."WARP ENGINE",
400 IFJ=6P."PHOTON TORPEDO TUBES",
405 IFJ=7P."SHIELD",
410 IFI=R.
415 P."DAMAGED, ",I," STARDATES ESTIMATED FOR REPAIR":R.
420 P."STATUS REPORT:":P."STARDATE",#10.3230-D:P."TIME LEFT",#7:D
425 P."CONDITION ",IFOP."DOCKED":G.445
430 IFN:P."RED":G.445
435 IFE<9999P."YELLOW":G.445
440 P."GREEN"
445 P."POSITION ",U,V," S-",X,Y:P."ENERGY",#12,E
450 P."TORPEDOES",#7,F:P."KLINGONS LEFT",#3,K:P."STARBASES",6,B
455 F.J=1TO7:IF@(J+63)GOS.375
460 N.J:G.120
465 J=5:GOS.375:IFI=0:P.
470 IN."SECTOR DISTANCE";W:IFW<1:G.120
475 IFI(W<2):P."CHEKOV: "WE CAN TRY 2 AT MOST, SIR.":G.470
480 IFW>91:W=91:P."SPOCK: "ARE YOU SURE, CAPTAIN?"
485 IFE<WW/2:P."SCOTTY: "SIR, WE DO NOT HAVE THE ENERGY.":G.120
490 GOS.615:IFR=0:G.120
495 D=D-1:E=E-WW/2:@(8X+Y+62)=8
500 F.M=64TO70:@(M)=(@(M)-1)(@(M)>0):N.M
505 P=45X+22:G=45Y+22:W=45W:IF.M=1TO5:W=W-R:IFW<-220:G.525
510 P=P+S:G=G+T:I=P/45:J=G/45:IF(I<1)+(I>8)+(J<1)+(J>8):G.530
515 IFF@(8I+J+62)=0:X=I:Y=J:N.M
520 P."EMERGENCY STOP!":P."SPOCK: "TO ERR IS HUMAN."
525 @(8X+Y+62)=A:GOS.175:G.65
530 P=U72+P/5+W/5:S/R-9:U=P/72:V=V72+E/5+W/5:T/R-9:V=G/72
535 IFR*(9)<2:P."SPACE STORM":T=100:GOS.360
540 IF(U>0)+(U>9)+(V>0)+(V>9):X=(P+9-72U)/9:Y=(G+9-72V)/9:G.45
545 P."YOU WANDERED OUTSIDE THE GALAXY**"
550 P."ON BOARD COMPUTER TAKES OVER, AND SAVED YOUR LIFE":G.48
555 J=6:GOS.375:IFI:G.120
500 F.M=64TO70:0(M)=(0(M)-1)*(0(M)>0):N.M
505 P=45*X+22,G=45*Y+22,W=45*W:IF.M=1TO5:W=W-R:IFW<-22G.525
510 P=P+S,G=G+T:I=P/45:J=G/45:IF(I<1)+(I>8)+(J<1)+(J>8)G.530
515 IF@(8*I+J+62)=0:X=I:Y=J:N.M
520 P."...EMERGENCY STOP...":P."SPOCK: "TO ERR IS HUMAN."
525 @(8*X+Y+62)=A:GOS.175:G.65
530 P=U*72+P/5+W/5:S/R-9:U=P/72:V=V*72+E/5+W/5:T/R-9:V=G/72
535 IFR*(9)<2:P."***SPACE STORM***":T=100:GOS.360
540 IF(U>0)+(U>9)+(V>0)+(V>9):X=(P+9-72*U)/9:Y=(G+9-72*V)/9:G.45
545 P."**YOU WANDERED OUTSIDE THE GALAXY**
550 P."ON BOARD COMPUTER TAKES OVER, AND SAVED YOUR LIFE":G.48
555 J=6:GOS.375:IFI:G.120
560 IFF=0:P."EMPTY":G.120
565 P."LOADED":GOS.615:IFR=0:G.120
570 P."TORPEDO TRACK ",J=F-1:P=45*X+22:G=45*Y+22:IF.M=1TO8
575 P=P+S,G=G+T:I=P/45:J=G/45:IF(I<1)+(I>8)+(J<1)+(J>8)G.585
580 L=8*I+J+62,W=8*U+V-9,R=@(W)/A*((W)>0):P.I,1,J," ",G.585+5*@(L)
585 N.M:P."...MISSED":G.65
590 S=R*(99)+200:IF.M=135TO140:IF@(M+6)=1)*(@(M+12)=J)GOS.305
592 N.M:G.65
595 B=B-1:@(L)=0:@(W)=@(W)-10:R:P."STARBASE DESTROYED"
597 P."SPOCK: "I OFTEN FIND HUMAN BEHAVIOUR FASCINATING.":G.65
600 P."HIT A STAR":IFR*(9)<3:P."TORPEDO ABSORBED":G.65
605 @(L)=@(W)=0:K=K:IFR*(9)<5:P."STAR DESTROYED":G.65
610 T=300:P."IT NOVAS ***RADIATION ALARM***":GOS.360:G.65
615 IN."COURSE (0-360)";I:IF(I<360)+(I>0):R.
620 S=(I+45)/90,I=I-S*90,R=(45*I+1)/11+45:G.625+5*(S<4)*S
625 S=-45,T=1:R.
630 S=1,T=45:R.
635 S=45,T=1:R.
640 S=-1,T=-45:R.