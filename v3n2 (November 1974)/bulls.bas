10 DIM A$[20],B$[20],C$[20],A[20],G[20],H[20],Y[40]
20 PRINT "Instructions";
30 INPUT B$
40 IF B$[1,1]#"Y" THEN 250
50 PRINT
60 PRINT "You are about to play 'bulls and cleots,' by D. Austin Stephens."
70 PRINT
80 PRINT "It is a word-guessing game which both you and the computer play"
90 PRINT "at the same time.  Each side composes a random N-character word,"
100 PRINT "with no character used more than once.  The the computer guesses at"
110 PRINT "your word, you respond, and guess at its word. It then responds"
120 PRINT "to your guess. The responses are the number of bulls and cleots"
130 PRINT "in the guess. A bull is a correct character in the correct place, &"
140 PRINT "a cleot is a character in the wrong place. For example:"
150 PRINT
160 PRINT " No.      Guess   Responses"
170 PRINT
180 PRINT " ABCD     ABCF    3 bulls, 0 cleots."
190 PRINT " 0%34     %356    0 bulls, 2 cleots."
200 PRINT " WXYZ     WXYZ    4 bulls, 0 cleots."
210 PRINT
220 PRINT "Of course, the one to first guess 'N bulls' is the winner."
230 PRINT
240 PRINT "Good luck."
250 PRINT "Character set";
260 INPUT C$
270 P9=LEN(C$)
280 FOR I=1 TO P9-1
290 FOR J=I+1 TO P9
300 IF C$[I,I]=C$[J,J] THEN 340
310 NEXT J
320 NEXT I
330 GOTO 360
340 PRINT "No character may be used more than once. Try again."
350 GOTO 250
360 PRINT "Number of characters in a word";
370 INPUT Z
380 IF Z<P9-2 AND Z>2 AND Z=INT(Z) THEN 410
390 PRINT "Try another number."
400 GOTO 360
410 FOR I=1 TO P9
420 P9=LEN(C$)
430 Y[I]=I
440 NEXT I
450 FOR I=P9+1 TO 40
460 Y[I]=-1
470 NEXT I
480 FOR I=1 TO P9
490 A=FNS(P9)
500 B=FNS(P9)
510 T=Y[A]
520 Y[A]=Y[B]
530 Y[B]=T
540 NEXT I
550 FOR I=1 TO Z
560 H[I]=FNS(P9)
570 FOR J=1 TO I-1
580 IF H[I]=H[J] THEN 560
590 NEXT J
600 NEXT I
610 FOR I=1 TO Z
620 GOSUB 810
630 A[I]=N
640 A$[I,I]="O"
650 NEXT I
660 B=C=F=0
670 GOSUB 1340
680 IF B=Z THEN 2120
690 IF B1=Z THEN 2190
700 IF B+C=Z THEN 1690
710 IF B+C=0 THEN 610
720 A=0
730 GOTO 870
740 DEF FNS(X)=1+INT(RND(0)*X)
750 FOR Z8=P9+1 TO 2 STEP -1
760 Y[Z8]-Y[Z8-1]
770 NEXT Z8
780 Y[1]=N
790 P9=P9+1
800 RETURN
810 N=Y[1]
820 FOR Z8=1 TO P9
830 Y[Z8]=Y[Z8]+1
840 NEXT Z8
850 P9=P9-1
860 RETURN
810 A=A+1
880 IF A>Z THEN 720
890 IF A$[A,A]#"O" THEN 870
900 G=A[A]
910 GOSUB 1340
920 A[A]=N
930 GOSUB 1320
940 IF B=Z THEN 2120
950 IF B1=Z THEN 2190
960 IF B+C=Z THEN 1690
970 IF B+C=0 THEN 610
980 IF B>B0 AND C=C0 THEN 1080
990 IF B<B0 AND C=C0 THEN 1300
1000 IF B=B0 AND C<C0 THEN 1160
1010 IF B=B0 AND C>C0 THEN 1200
1020 IF B>B0 AND C<C0 THEN 1230
1030 IF B<B0 AND C>C0 THEN 1260
1040 IF B=B0 AND C=C0 THEN 1300
1050 PRINT "Huh? Try again."
1060 INPUT B,C
1070 GOTO 940
1080 P=G
1090 GOTO 1140
1100 A[A]=G
1110 F=A[A]
1120 B=B+1
1130 A[A]=G
1140 A$[A,A]="X"
1150 GOTO 870
1160 F=A[A]
1170 A[A]=G
1180 C=C+1
1190 GOTO 1210
1200 F=G
1210 A$[A,A]="C"
1220 GOTO 870
1230 N=G
1240 GOSUB 750
1250 GOTO 1140
1260 N=A[A]
1270 GOSUB 750
1280 A[A]=G
1290 GOTO 1140
1300 Y[P9+1]=A[A]
1310 P9=P9+1
1320 A[A]=G
1330 GOTO 870
1340 PRINT
1350 PRINT "I guess ";
1360 FOR M=1 TO Z
1370 PRINT C$[A[M],A[M]];
1380 NEXT M
1390 PRINT "."
1400 PRINT "how many bulls and cleots";
1410 B0=B
1420 C0=C
1430 INPUT B,C
1440 PRINT
1450 IF B=Z THEN 2120
1460 B1=C1=0
1470 PRINT "What is your guess";
1480 INPUT B$
1490 FOR Q=1 TO Z
1500 FOR K=1 TO LEN(C$)
1510 IF C$[K,K]=B$[Q,Q] THEN 1530
1520 NEXT K
1530 G[Q]=K
1540 NEXT Q
1550 FOR Q=1 TO Z
1560 FOR E=1 TO Z
1570 IF G[Q]#H[E] THEN 1590
1580 C1=C1+1
1590 NEXT E
1600 NEXT Q
1610 FOR Q=1 TO Z
1620 IF H[Q]#G[Q] THEN 1640
1650 C1=C1-B1
1660 PRINT "You guessed";b; bulls and";C1;" cleots."
1670 PRINT
1680 RETURN
1690 IF P#0 THEN 1740
1700 F=FNS(LEN(C$))
1710 FOR I=1 TO Z
1720 IF A[I]=F THEN 1700
1730 NEXT I
1740 FOR I=1 TO Z-1
1750 IF A$[I,I]="X" THEN 2100
1760 FOR J=I+1 TO Z
1770 IF A$[J,J]="X" THEN 2090
1780 T=A[I]
1790 A[I]=A[J]
1800 A[J]=T
1810 GOSUB 1340
1820 IF B=Z THEN 2120
1830 IF B1=Z THEN 2190
1840 IF B0+2=B THEN 2040
1850 IF B0+1=B THEN 2060
1860 IF B=B0 THEN 2060
1870 T=A[I]
1880 A[I]=A[J]
1890 A[J]=T
1900 R=A[I]
1910 A[I]=F
1920 GOSUB 1340
1930 IF B=Z THEN 1680
1940 IF B1=Z THEN 2190
1950 IF B+1=B0 THEN 2000
1960 A[I]=R
1970 B=B+1
1980 A$[J,J]="X"
1900 GOTO 2090
2000 A[I]=R
2010 A$[I,I]="X"
2020 B=+1
2030 GOTO 2010
2060 GOTO 2010
2060 T=A[I]
2070 A[I]=A[J]
2080 A[J]=T
2090 NEXT J
2100 NEXT I
2110 GOTO 1740
2120 PRINT "I win!"
2130 PRINT "My number was ";
2140 FOR I=1 TO Z
2150 PRINT C$[I,I];
2160 NEXT I
2170 PRINT ". Again";
2180 GOTO 2200
2190 PRINT "Some luck. Again";
2200 PRINT B$
2210 IF B$[1,1]#"Y" THEN 2260
2220 PRINT "Do you want a new character set";
2230 INPUT B$
2240 IF B$[1,1]="Y" THEN 250
2250 GOTO 410
2260 END
