10 REM "KINGDOM" FOR TSS/8 BASIC
11 REM
12 REM VERSION 1   MOD 2    12/28/73
14 REM
15 REM WRITTEN BY:
16 REM     T. VOKOS        A.O. SMITH CORP.
17 REM     L. SCHNEIDER    UWM, MILWAUKEE
18 REM
20 RANDOMIZE
25 DEF FNR(Z1)=INT(INT(Z1)*RND(0))
30 DEF FNL(Z2)=FNR(100)-Z2
98 REM ***SET INITIAL PARAMETERS***
99 REM
100 LET Y=0
105 LET L0=10*6
110 LET L1=3
115 LET N0=FNR(75)+75
120 LET L2=FNR(250)+250
125 LET N1=FNR(3000)+2000
130 LET L3=0
135 LET N2=0
136 PRINT
137 REM
139 REM
140 PRINT "<*> <*> <*> <*> <*> <*> <*> <*> <*> <*> <*> <*>"
145 PRINT
150 PRINT "REPORT FOR YEAR ";Y
155 PRINT
160 PRINT "POPULATION IS ";N0
165 PRINT "ACRES OF LAND OWNED ";L2
170 PRINT "BUSHELS IN STORAGE ";N1
175 PRINT "PRICE OF LAND IS ";L1;" BUSHELS PER ACRE"
180 PRINT
190 REM
192 REM ***READ AND VERIFY LAND TRANSACTIONS***
193 REM
215 PRINT "HOW MANY ACRES TO BUY?"
220 INPUT B
225 LET B=INT(B)
230 IF B<0 GOTO 2020
235 IF B=0 GOTO 270
240 LET A=N1-B*L1
245 IF A>=0 GOTO 260
255 PRINT "YOUR STORAGE IS ONLY ";N1;" BUSHELS!"
260 GOTO 215
265 LET N1=A
268 LET L2=L2+B
275 PRINT "TO SELL?"
278 INPUT C
280 LET C=INT(C)
285 IF C<0 GOTO 2020
290 IF C=0 GOTO 325
295 LET A=L2-C
300 IF A>=0 GOTO 315
305 PRINT "YOU ONLY OWN ";L2;" ACRES!"
310 GOTO 270
315 LET L2=A
320 LET N1=N1+C*L1
325 IF (B+C)<>0 GOTO 335
330 PRINT "TRANSACTION RESULTS: LAND ";L2;" ACRES; GRAIN ";N1;" BUSHELS"
332 REM
333 REM ***TEST FOR WIN***
334 REM
335 IF (L2+N1-L0)>=0 GOTO 2010
340 IF N1=0 GOTO 490
342 REM
343 REM ***READ AND VERIFY FOOD AND SEED ALLOTMENT***
344 REM
345 PRINT
350 PRINT "HOW MANY BUSHELS FOR FOOD?"
355 INPUT N2
360 N2=INT(N2)
365 IF N2<0 GOTO 2020
370 LET A=N1-N2
375 IF A>=0 GOTO 390
385 PRINT "YOUR STORAGE IS ONLY ";N1;" BUSHELS!"
386 GOTO 350
390 LET N1=A
395 IF N1=0 GOTO 490
400 PRINT "HOW MANY ACRES TO BE PLANTED?"
405 INPUT L3
410 LET L3=INT(L3)
415 IF L3<0 GOTO 2020
420 IF L3=0 GOTO 500
425 IF (L2-L3)>=0 GOTO 440
430 PRINT "YOU ONLY OWN ";L2;" ACRES!"
435 GOTO 400
440 IF (2*N0-L3)>=0 GOTO 455
445 PRINT "YOUR POPULATION IS ONLY ";N0;" PEOPLE!"
450 GOTO 400
455 LET A=N1-3*L3
460 IF A>=0 GOTO 475
465 PRINT "YOUR STORAGE IS ONLY ";N1;" BUSHELS!"
470 GOTO 400
475 LET N1=A
480 IF N1=0 GOTO 500
490 PRINT
495 PRINT "STORAGE IS NOW EMPTY...GOOD LUCK!"
497 REM
498 REM ***COMPUTE EFFECTS OF FOOD ALLOTMENT***
499 REM
500 LET Y=Y+1
505 LET N3=FNR(N0/3+3)
510 LET N4=FNR(N0/4+2)
515 LET N5=N0-INT(N2/10)
520 IF N5>0 GOTO 560
525 IF N5=0 GOTO 590
535 LET A=FNR(N3-N5/2)
536 PRINT
540 PRINT "***FOOD SURPLUS***  POPULATION INCREASE ";A
545 LET N5=0
550 LET N3=N3+A
555 GOTO 590
560 IF (FNL(5*(N5-2)))<>0 GOTO 590
565 LET A=FNR(N5*N1/2*N0))
570 PRINT
575 PRINT "***FOOD RIOTS*** ";A;" BUSHELS LOST"
580 LET N1=N1-A
590 IF FNL(10) >0 GOTO 620
595 LET A=INT(N3+FNR(N2/2+2))
597 REM
598 REM ***COMPUTE RANDOM OCCURANCES***
599 REM
600 PRINT
605 PRINT "***PLAGUE*** ";A;" DIED"
610 LET N4=N4+A
620 IF FNL(1) >0 GOTO 670
625 LET A=FNR(N2/5)-INT(N0/5)
630 LET B=FNR(N1/28)+INT(N1/28)
635 LET C=FNR(L2/56)
640 PRINT
645 PRINT "***HUNS ATTACK***"
650 PRINT A;" PEOPLE KILLED ";B;" BUSHELS TAKEN ";C;" ACRES DESTROYED"
655 LET N4=N4+A
660 LET N1=N1-B
665 LET L2=L2-C
670 IF FNL(15) >0 GOTO 705
675 LET A=FNR(N1/6)
680 LET B=FNR(N0*258)+50
685 PRINT
690 PRINT "***BORDER EXPANSION*** YOU GAINED ";A;" PEOPLE ";B;" ACRES"
695 LET N3=N3+A
700 LET L2=L2+B
705 LET N0=N3+N4-N5
710 IF N0=0 GOTO 2015
715 PRINT
720 PRINT N3;" ARRIVED"
735 PRINT N4;" DIED OF STARVATION"
730 PRINT N4;" DIED NATURAL CAUSES"
735 IF FNL(10) >0 GOTO 760
740 LET A=FNR(N1/20)+INT(N1/20)
745 PRINT
750 PRINT "***THEFT*** ";A;" BUSHELS STOLEN"
755 LET N1=N1-A
760 IF FNL(10) <> 0 GOTO 785
765 LET A=FNR(L2/10)+INT(L2/20)
770 PRINT
775 PRINT "**********EARTHQUAKE********** ";A;" ACRES DESTROYED"
780 LET L2=L2-A
785 IF FNL(15) >0 GOTO 810
790 LET A=FNR(100*INT(L2/100))+500
795 PRINT
800 PRINT "***GRAIN SHIPMENT ARRIVES*** ";A;" BUSHELS"
805 LET N1=N1+A
810 IF FNL(15)> 0 GOTO 835
815 LET L1=FNR(2)+1
820 PRINT
825 PRINT "***DROUGHT***"
830 GOTO 860
835 IF FNL(15) >0 GOTO 852
840 LET L1=FNR(3)+7
845 PRINT
850 PRINT "***RAIN***"
851 GOTO 860
852 LET L1=FNR(4)+3
855 REM
856 REM ***COMPUTE HARVEST***
857 REM
860 LET A=L1*L3
865 LET B=FNR(A/2)
870 LET C=A-B
875 PRINT
880 PRINT
885 IF A=0 GOTO 910
890 PRINT "HARVEST WAS ";L1;" BUSHELS PER ACRE FOR A TOTAL ";A;" BUSHELS"
895 PRINT "LOSS TO RATS ";B;" BUSHELS; NET HARVEST WAS ";C;" BUSHELS"
900 LET N1=N1+C
905 GOTO 130
910 PRINT "HARVEST WAS ";L1;" BUSHELS PER ACRE FOR A TOTAL ";A;" BUSHELS"
915 GOTO 900
2000 REM
2001 REM ***SPECIAL MESSAGES FOR ENDINGS***
2005 REM
2010 PRINT
2011 PRINT "***CONGRATULATIONS*** YOU NOW RULE THE WORLD!"
2012 GOTO 2020
2015 PRINT
2016 PRINT "***DISASTER*** - THERE ARE NO MORE PEOPLE LEFT!"
2020 PRINT
2021 PRINT "YOUR REIGN LASTED ";Y;" YEARS"
2046 END
