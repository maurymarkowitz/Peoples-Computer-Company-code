100 * NAME: ELEMLIB****MOTIE
110 *
120 * BY: MAC OGLESBY IN JUNE 1975.
130 *
140 * DESCRIPTION: THE MOTIES ARE NON-HUMANS POSSESSING INCREDIBLE
150 * TECHNOLOGICAL BRILLIANCE. THEY BREED AS RAPIDLY AS BACTERIA
160 * AND DESPERATELY NEED MORE ROOM. IF THEY ELUDE THE GUARDIAN
170 * STARSHIPS PROTECTING THE ONLY GATEWAY BETWEEN THE MOTIE WORLD
180 * AND THE HUMAN EMPIRE, HUMANKIND WILL BE ENSLAVED, IF NOT
190 * EXTERMINATED.
200 *
210 * INSTRUCTIONS: TYPE "RUN" FOR COMPLETE INSTRUCTIONS.
220 *
230 * REMARKS: THE SCENARIO FOR THIS GAME WAS ADAPTED FROM THE NOVEL
240 *   "A MOTE IN GOD'S EYE" BY L. NIVEN AND J. POURNELLE.
250 *   THE GAME ITSELF IS AN ADAPTATION OF "THE SOLDIER'S GAME"
260 *   DESCRIBED IN DETAIL IN "THE MASTER BOOK OF MATHEMATICAL
270 *   RECREATIONS" BY F. SCHUH (DOVER).
280 *
290 *
300 *
310 DIM C$(15)                        'SAVE ROOM FOR 15 TURNS
320 RANDOMIZE
330 FOR J=0 TO 10
340    READ C(J)                      '# OF LEGAL GUARDIAN MOVES FROM J
350 NEXT J
360    DATA 3,3,3,3,2,5,2,2,3,2,0
370 FOR J=0 TO 10
380    READ F(J)                      '# OF LEGAL MOTIE MOVES FROM J
390 NEXT J
400    DATA 3,4,4,4,3,8,3,4,4,4,3
410 FOR J=0 TO 10
420    FOR K=1 TO C(J)
430       READ D(J,K)                 'LOCATIONS GUARDIAN CAN GO TO FROM J
440    NEXT K
450 NEXT J
460    DATA 1,2,3,  2,4,5,  1,3,5,  2,5,6,  5,7,  4,6,7,8,9,  5,9
470    DATA 8,10,  7,9,10,  8,10,  NONE
480 FOR J=0 TO 10
490    FOR K=1 TO F(J)
500       READ G(J,K)                 'LOCATIONS MOTIE CAN GO TO FROM J
510    NEXT K
520 NEXT J
530    DATA 1,2,3,  0,2,4,5,  0,1,3,5,  0,2,5,6,  1,5,7,  1,2,3,4,6,7,8,9
540    DATA 3,5,9,  4,5,8,10,  5,7,9,10,  5,6,8,10,  7,8,9
550 FOR J=0 TO 10
560    LET B$(J)=STR$(J)              'B$() STORES DISPLAY STRINGS
570 NEXT J
580
590 PRINT "WANT INSTRUCTIONS FOR MOTIE?";
600 LINPUT I$
610 IF SEG$(I$,1,1)<>"Y" THEN 640
620    GOSUB 2870                     'GO PRINT INSTRUCTIONS
630    GOTO 660
640 GOSUB 2520                        'SHOW HOW BOARD IS NUMBERED
650
660 PRINT "HOW MANY PLAYERS (1 OR 2)";  'REPLAY RETURNS TO HERE
670 INPUT P
680 IF P=1 THEN 780                   'COMPUTER LOCATES MOTIE
690    IF P=2 THEN 710
700       GOTO 660
710    PRINT "WHERE IS THE MOTIE VESSEL FIRST DETECTED";
720    INPUT G                        'G IS MOTIE LOCATION
730    IF (10-G)*(G-2)<0 THEN 760     'MOTIE STARTS AT 2-10 (BUT NOT 3)
740        IF G=3 THEN 760
750           GOTO 830
760    PRINT "CHOOSE LOCATION 2-10 (BUT NOT 3)."
770    GOTO 710
780 LET G=2+INT(RND*9)
790 IF G<>3 THEN 810
800    GOTO 780
810 PRINT "OK, I'LL MOVE THE MOTIE VESSEL, FIRST DETECTED AT";G
820
830 LET B$(0)="*"                     'PLACE PIECES ON THE BOARD
840 LET B$(1)="*"
850 LET B$(3)="*"
860 LET B$(G)="&"
870 GOSUB 2680                        'RECORD INITIAL POSITIONS
880 PRINT
890 PRINT "* = GUARDIANS   & = MOTIE"
900 GOSUB 2740                        'PRINT DISPLAY
910
920 PRINT "   GUARDIAN (*) MOVE";
930 LINPUT G$
940 LET G1$=SEG$(G$,1,1)
950 IF G1$="S" THEN 1030
960    IF G1$="R" THEN 1010
970       IF G1$="H" THEN 990
980          GOTO 1050                'CONTINUE
990       GOSUB 3090                  'PRINT PART OF INSTRUCTIONS
1000       GOTO 920
1010   PRINT "THE GUARDIANS HAVE GIVEN UP!!"
1020   GOTO 2210
1030 PRINT "PROGRAM HALTED"
1040 STOP
1058 IF LEN(G$)>10 THEN 1290
1060    LET Z1=0                      'ROUTINE TO DROP COMMAS, ETC.
1070    CHANGE G$ TO Z
1080    FOR J=1 TO Z(0)
1090       IF (ASC(9)-Z(J))*(Z(J)-ASC(0))<0 THEN 1120
1100          LET Z1=Z1+1
1110          LET Z(Z1)=Z(J)
1120    NEXT J
1130    LET Z(0)=Z1
1140    CHANGE Z TO G$
1150    IF (3-LEN(G$))*(LEN(G$)-2)<>0 THEN 1290
1160       IF LEN(G$)=2 THEN 1210
1170          LET G1=VAL(SEGS(G$,2,2))
1180          IF G1>10 THEN 1280
1190             GOTO 1220
1200          GOTO 1290
1210       LET G1=VAL(SEGS(G$,2,2))
1220       LET G0=VAL(SEGS(G$,1,1))
1230       IF B$(G0)<>"*" THEN 1290   'NO GUARDIAN AT B$(G0)
1240          IF STR$(G1)>B$(G1) THEN 1290  'B$() IS OCCUPIED
1250             FOR K=1 TO C(G0)
1260                IF G1=D(G0,K) THEN 1280
1270                   GOTO 1330      'LEGAL MOVE
1280             NEXT K
1298 PRINT "ILLEGAL MOVE. INPUT IGNORED."
1300 PRINT "FOR INSTRUCTIONS, TYPE HELP AS YOUR MOVE."
1310 GOTO 920
1320
1330 LET T=T+1                        'INCREMENT TURN COUNTER
1340 LET B$(G1)="*"
1350 LET B$(G0)=STR$(G0)
1360 GOSUB 2680                       'RECORD POSITIONS
1370
1380 IF P=1 THEN 1780                 'LET COMPUTER MOVE MOTIE
1390    IF C$(T)="0*23&*6*8910" THEN 1430 'CHECK FOR GUARDIAN WIN
1400       IF C$(T)="012*4*&78*10" THEN 1430
1410          IF C$(T)="0123456***&" THEN 1430
1420             GOTO 1440            'CONTINUE
1430    GOTO 1850                     'GUARDIAN WIN
1440    PRINT "MOTIE (&) MOVE";
1450    LINPUT G$
1460    LET G1$=SEG$(G$,1,1)
1470    IF G1$="S" THEN 1550
1480       IF G1$="R" THEN 1530
1490          IF G1$="H" THEN 1510
1500             GOTO 1570            'CONTINUE
1510          GOSUB 3090              'PRINT PART OF INSTRUCTIONS
1520          GOTO 1440
1530       PRINT "THE MOTIE VESSEL GIVES UP!"
1540       GOTO 2390                  'REPLAY?
1550    PRINT "PROGRAM HALTED"
1560    STOP
1570    IF LEN(G$)>10 THEN 1738
1580       CHANGE G$ TO Z
1590       IF Z(0)>2 THEN 1738     'TOO MUCH MOVE
1600          IF Z(0)=1 THEN 1660
1610             IF Z(1)<>49 THEN 1650
1620                IF Z(2)<>48 THEN 1650
1630                   LET G1=10
1640                   GOTO 1680
1650                GOTO 1730
1660          LET G1=Z(1)-48
1670          IF (9-G1)*G1<0 THEN 1730
1680             IF B$(G1)<>STR$(G1) THEN 1730
1690                FOR K=1 TO F(G)
1700                   IF G1<>G(G,K) THEN 1720
1710                      GOTO 2060    'LEGAL MOVE
1720                NEXT K
1730    PRINT "ILLEGAL MOVE.  INPUT IGNORED."
1734    PRINT "FOR INSTRUCTIONS, TYPE HELP AS YOUR MOVE."
1750    GOTO 1440
1760
1770    ' COMPUTER MOVES MOTIE
1780  LET T9=0                        'RESET COUNTER
1790  FOR K=1 TO F(G)
1800    IF BS(G(G,K))="*" THEN 1830   'GUARDIAN AT BS(G)
1810    LET T9=T9+1
1820    LET H(T9)=G(G,K)              'IDENTIFY MOTIE'S POSSIBLE MOVES
1830  NEXT K
1840  IF T9<>0 THEN 1868              'MOTIE NOT TRAPPED
1850    PRINT "MOTIE VESSEL CANNOT MOVE!"
1860    PRINT "THE GUARDIANS HAVE SAVED THE HUMAN GALACTIC EMPIRE!"
1870    GOTO 2390                     'REPLAY?
1880  FOR K=1 TO T9
1890    LET G1=H(K)
1900    IF T9=1 THEN 2050             'NO CHOICE OF MOVES
1910       IF G1=4 THEN 2030          'MINIMAL STRATEGY SECTION AVOIDS
1920          IF G1=6 THEN 2000       'SOME OF THE OBVIOUS BLUNDERS
1930             IF G1<>8 THEN 1990
1940                IF C$(T)="0123**6&8*10" THEN 1980
1950                   IF C$(T)="01234***8&10" THEN 1980
1960                      IF C$(T)="01234***89&" THEN 1980
1970                         GOTO 2080
1980                GOTO 2060
1990             GOTO 2080
2000          IF C$(T)="012*4*67*&10" THEN 2020
2010             GOTO 2080
2020          GOTO 2060
2030      IF C$(T)<>"0*234*6&*910" THEN 2050
2040         GOTO 2080
2050      GOTO 2060
2060  NEXT K
2070
2080  LET B$(G1)="&"
2090  LET B$(G)=STR$(G)
2100  LET G=G1
2210  IF P=2 THEN 2130
2120     PRINT "MOTIE (&) GOES TO";G
2130  LET C$(T)=""                    'WIPE C$(T) CLEAN
2140  GOSUB 2680                      'RECORD POSITIONS AFTER TURN T
2150  GOSUB 2740                      'PRINT DISPLAY
2160
2170 ' ROUTINES TO CHECK FOR MOTIE WIN
2180 IF B$(0)<>"&" THEN 2230
2190    PRINT
2200    PRINT "THE MOTIE VESSEL HAS REACHED THE EMPIRE WORLDS!"
2210    PRINT "MAY ROCKEFORD PROTECT US!!"
2220    GOTO 2390
2230 IF T<15 THEN 2280
2240   PRINT
2250   PRINT "THE MOTIE VESSEL IS STILL LOOSE AFTER 15 MOVES!"
2260   PRINT "THE GUARDIANS HAVE FAILED!"
2270   GOTO 2390
2280 LET T9=0                         'RESET COUNTER
2290 FOR J=1 TO T-1
2300    IF C$(T)<>C$(J) THEN 2360
2310    LET T9=T9+1
2320    IF T9<2 THEN 2360
2330       PRINT
2340       PRINT "THAT'S 3 TIMES WE'VE SEEN THIS DISPLAY!"
2350       GOTO 2260
2360 NEXT J
2370 GOTO 920                         'GET NEXT GUARDIAN MOVE
2380
2390 PRINT
2400 PRINT "REPLAY";
2410 LINPUT I$
2420 IF SEG$(I$,1,1)<>"Y" THEN 2490
2430    FOR J=0 TO 10
2440       LET B$(J)=STR$(J)          'RESET B$()
2450    NEXT J
2460    MAT C$=NUL$                   'RESET C$()
2470    LET T=0                       'RESET TURN COUNTER
2480    GOTO 660
2490 STOP
2500 ' THIS LINE NOT IN THE ORIGINAL PRINTOUT, APPARENTLY CLIPPED OUT
2510 ' PRINT HOW BOARD IS NUMBERED
2520 PRINT
2530 PRINT "MOTIE WORLD"
2540 PRINT "  10"
2550 PRINT " /:\"
2560 PRINT "7-8-9"
2570 PRINT ":\:/:  ALDERSON"
2580 PRINT "4-5-6  INTERSTELLAR"
2590 PRINT ":/:\:  JUMP POINTS"
2600 PRINT "1-2-3"
2610 PRINT " \:/"
2620 PRINT "  0"
2630 PRINT "HUMAN EMPIRE"
2640 PRINT
2650 RETURN
2660
2670 ' ROUTINE TO RECORD CURRENT POSITIONS
2680 FOR J=0 TO 10
2690   LET C$(T)=C$(T)&B$(J)
2700 NEXT J
2710 RETURN
2720
2730 ' PRINT DISPLAY
2740 PRINT
2750 PRINT "  ";B$(10)
2760 PRINT " /:\"
2770 PRINT B$(7);"-";B$(8);"-";B$(9)
2780 PRINT ":\:/:  TIME";T
2790 PRINT B$(4);"-";B$(5);"-";B$(6)
2800 PRINT ":/:\:"
2810 PRINT B$(1);"-";B$(2);"-";B$(3)
2820 PRINT " \:/"
2830 PRINT "  ";B$(0)
2840 RETURN
2850
2860 ' PRINT INSTRUCTIONS
2870 PRINT
2880 PRINT "BACKGROUND----"
2890 PRINT "  IN THE DISTANT FUTURE HUMANS CONTROL MOST OF THE GALAXY."
2900 PRINT "TRAVEL BETWEEN STAR SYSTEMS INVOLVES SPACE WARP JUMPS FROM"
2910 PRINT "ONE 'ALDERSON' POINT TO ANOTHER. T HE MOTIES ARE THE ONLY"
2920 PRINT "INTELLIGENT NON-HUMAN CREATURES EVER DISCOVERED.  ALTHOUGH"
2930 PRINT "BRILLIANT IN TECHNOLOGY, THE MOTIES CANNOT CONTROL THEIR"
2940 PRINT "POPULATION GROWTH AND DESPERATELY NEED NEW WORLDS.  EVER"
2950 PRINT "SINCE LEARNING OF THE ALDERSON JUMP POINTS THEY HAVE BEEN"
2960 PRINT "TRYING TO REACH AND OCCUPY THE HUMAN EMPIRE."
2970 PRINT
2980 PRINT "MAP OF JUMP POINTS BETWEEN MOTIE WORLD AND HUMAN EMPIRE:"
2990 GOSUB 2520
3000 PRINT "THE GAME----"
3010 PRINT "  MOTIE MAY BE PLAYED BY 1 OR 2 PLAYERS.  THE COMPUTER"
3020 PRINT "MAKES THE MOTIE MOVES IF THERE IS ONLY ONE PLAYER."
3030 PRINT
3040 PRINT "  THE EMPIRE IS PROTECTED BY 3 GUARDIAN STARSHIPS, LOCATED"
3050 PRINT "AT 0, 1, AND 3. THE MOTIE VESSEL IS PLACED BY THE PLAYER"
3060 PRINT "OR BY THE COMPUTER AT ANY VACANT POINT."
3070 PRINT
3080 PRINT "  THE PLAYERS GO IN TURN, AND MUST MOVE IF POSSIBLE."
3090 PRINT "IN GENERAL, TO MOVE MEANS TO TRANSFER A PIECE TO AN ADJACENT"
3100 PRINT "VACANT POINT WHICH IS CONNECTED TO THE PRESENT LOCATION."
3110 PRINT "THERE ARE NO CAPTURES."
3120 PRINT
3130 PRINT "GUARDIANS WIN IF THE MOTIE IS TRAPPED (HAS NO LEGAL MOVE)."
3140 PRINT
3150 PRINT "MOTIES WIN IF STILL UNTRAPPED AFTER 15 TURNS, IF THERE IS"
3160 PRINT "3-TIME REPETITION OF POSITION, OR IF THEY REACH LOCATION 0."
3170 PRINT
3180 PRINT "GUARDIANS (*) CAN ONLY MOVE FORWARD (UP) OR SIDEWAYS,"
3190 PRINT "NEVER BACKWARD (DOWN).  FOR EXAMPLE, A GUARDIAN AT 3 MAY"
3200 PRINT "GO TO 2, 5, OR 6.  TO MOVE A GUARDIAN, TYPE 2 NUMBERS: FIRST,"
3210 PRINT "PRESENT LOCATION; SECOND, WHERE YOU WANT TO GO.  FOR EXAMPLE,"
3220 PRINT "35 MEANS THE GUARDIAN AT 3 WANTS TO GO TO 5."
3230 PRINT
3240 PRINT "THE MOTIE (&) CAN MOVE IN ANY DIRECTION.  FOR EXAMPLE, MOTIE"
3250 PRINT "AT 7 MAY GO TO 4, 5, 8, OR 10.  TO MOVE THE MOTIE, JUST TYPE"
3260 PRINT "THE LOCATION YOU WANT TO GO TO."
3270 PRINT
3280 PRINT "ALSO, TYPE S TO STOP, TYPE R TO RESIGN, TYPE H FOR HELP."
3290 PRINT
3300 RETURN
3310 END
