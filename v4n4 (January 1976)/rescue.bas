100 ' NAME:  RESCUE***
105 '
110 ' BY:  MAC OGLESBY ON 05/19/75
115 '
120 ' DESCRIPTION:  AS COMMANDER OF A RESCUE STARSHIP, THE USER SETS
125 '   OUT IN RESPONSE TO A DISTRESS CALL FROM THE STARSHIP KIEWIT.
130 '   THE PASSENGERS AND CREW CAN BE SAVED FROM CERTAIN DEATH IF
135 '   THE STARSHIP KIEWIT IS REACHED WITHIN A DOZEN MOVES.  CERTAIN
140 '   FACTORS COMPLICATE RESCUE EFFORTS.
145 '
150 ' INSTRUCTIONS:  TYPE "RUN" FOR COMPLETE INSTRUCTIONS.
155 '
160 ' CATEGORY:  GAMES***
165 '
170 ' LANGUAGE:  BASIC
175 '
180 ' INDEX LINE:
185 '     IS IT POSSIBLE TO !RESCUE THE !STARSHIP !KIEWIT?
190 '
195 '
200 ' INITIALIZATION
290 DIM D(12)                         'SAVE ROOM FOR DISPLAY STRING
300 RANDOMIZE
310 MAT READ B(6,6)                   'B(,) STORES DATA TO DETERMINE
320    DATA 1,0,1,0,1,0.              'IF RESCUE SHIP'S MOVE IS LEGAL.
330    DATA 0,1,0,1,0,1               'A MOVE TO ADJACENT SQUARE IS OK
340    DATA 1,0,10,11,1,0             'IF PRESENT B(,) VALUE + NEW B(,)
250    DATA 0,1,11,10,0,1             'VALUE <> 0,2, OR 11.
360    DATA 1,0,1,0,1,0
370    DATA 0,1,0,1,0,1
280 MAT READ G(3)                     'READ DATA FOR PROHIBITED MOVES
390    DATA 0,2,11
400 PRINT
410 PRINT "*** MAYDAY *** MAYDAY *** MAYDAY ***"
420 PRINT "INTERSTELLAR STARSHIP KIEWIT CALLING."
430 PRINT "COMPUTER DISC FAILURE MODIFIED OUR NAVIGATIONAL SOFTWARE"
440 PRINT "AND WE HAVE SCRAPED AGAINST ASTEROID #ASR-33.  OUR HULL AND"
450 PRINT "LIFEBOATS ARE DAMAGED.  MOST OF OUR LIFE-SUPPORT SYSTEMS"
460 PRINT "HAVE BEEN DESTROYED.  IMMEDIATE ASSISTANCE IS ESSENTIAL."
470 PRINT "*** MAYDAY *** MAYDAY *** MAYDAY ***"
480 LET T=12                          'SAVE KIEWIT WITHIN T MOVES
490 FOR J=1 TO 6                      'REPLAY RETURNS TO HERE
500    FOR K=1 TO 6                   'P(,) STORES 6 BY 6 DISPLAY
510       LET P(J,K)=32               'INITIALLY, EACH P(,)=32
520    NEXT K
530 NEXT J
540 LET W1=W2=0                       'RESET MOVE TALLY, RESET WIN FLAG
550 IF RND<.5 THEN 580                'STARSHIP KIEWIT INITIALLY MOVES
560    LET M=1                        'SOUTH IF M=1
570    GOTO 590
580 LET M=-1                          'NORTH IF M=1
590 LET R1=1+INT(RND*6)               'R1 IS ROW OF RESCUE SHIP
600 LET C1=6                          'C1 IS COLUMN OF RESCUE SHIP
610 LET P(R1,C1)=38                   'RESCUE SHIP SYMBOL IS &
620 LET C2=1+INT(RND*6)               'C2 IS COLUMN OF KIEWIT
630 LET R2=1+INT(RND*6)               'C2 IS ROW OF KIEWIT
640 IF P(R2,C2)=B(r2,c2) THEN 660     'START KIEWIT AT OPPOSITION
650    GOTO 620                       'TRY AGAIN
660 LET P(R2,C2)=42                   'KIEWIT SYMBOL IS *
670 PRINT
680 PRINT "DO YOU NEED INSTRUCTIONS"
690 LINPUT I$
700 IF SEG$(I$,1,1)<>"Y" THEN 720
710    GOSUB 2320
720 PRINT
730 PRINT "RESCUE STARSHIP (&) IS AT "STR$(R1);",";STR$(C1)
740 PRINT "STARSHIP KIEWIT (*) IS AT "STR$(R2);",";STR$(C2)
750 PRINT "SAVE STARSHIP KIEWIT BY MOVING INTO ITS SQUARE WITHIN"T;"MOVES"
760 PRINT
770 PRINT "MAP AT START"
780 GOTO 848
790
800 ' PRINT DISPLAY
810
820 PRINT
830 PRINT "MAP AFTER MOVE";W1
840 PRINT "  1 2 3 4 5 6"             'IDENTIFY COLUMNS
850 FOR J=1 TO 6                      '6 ROWS
860    PRINT STR$(J);                 'IDENTIFY EACH ROW
870    FOR K=6 TO 1 STEP -1           'ROUTINE TO IGNORE TRAILING SPACES
880       IF P(J,K)=32 THEN 900
890          GOTO 930
900    NEXT K
910    PRINT
920    GOTO 1060
930    LET D(0)=0                     'RESET DISPLAY STRING CHARACTER COUNT
940    FOR L=K TO 1 STEP -1
950       IF W2=0 THEN 1000           'NO WINNER YET
960          IF D(0)>0 THEN 1080      'WIN DISPLAY IS SET
970             LET D(2*L)=38
980             LET D(2*L-1)=42
990             GOTO 1020
1000      LET D(2*L)=P(J,L)            'ASSEMBLE DISPLAY STRING
1010      LET D(2*L-1)=32
1020      LET D(0 )=D(0)+2             'COUNT CHARACTERS
1030    NEXT L
1040    CHANGE D TO D$
1050    PRINT D$                       'PRINT BALANCE OF ROW J
1060 NEXT J
1070 IF W2=0 THEN 1170
1080
1090    ' WINNER!!
1100
1110    PRINT "THANK HEAVEN!! YOU'VE SAVED THE PEOPLE ABOARD STARSHIP KIEWIT"
1120    PRINT "REPLAY";
1130    LINPUT R$
1140    IF SEG$(R$,1,1)<>"Y" THEN 1160
1150       GOTO 490
1160    STOP
1170 IF W1<T THEN 1240                  'NOT 7TH MOVE
1180
1190    ' LOSER
1200
1210    PRINT "DISASTER!! THE PEOPLE ABOARD STARSHIP KIEWIT HAVE PERISHED"
1220    PRINT "FROM COLD AND LACK OF OXYGEN."
1230    GOTO 1120                       'ASK ABOUT REPLAY
1240 LET W1=W1+1                        'TALLY MOVES
1250
1260 ' GET USER'S MOVE
1270
1280 PRINT "RESCUE STARSHIP'S MOVE (ROW,COL)"; 
1290 LINPUT A$
1300 IF SEG$(A$,1,1)<>"S" THEN 1330     ' CONTINUE
1310    PRINT "PROGRAM HALTED"
1320    STOP
1330 IF A$<>"HELP" THEN 1600
1340
1350    ' HELP SECTION PRINTS LEGAL MOVES
1360
1370    PRINT "YOU ARE NOW AT (ROW,COL) ";STR$(R1);",";STR$(C1)
1380    PRINT "YOU MAY MOVE TO ANY OF THESE SQUARES (ROW,COL):"
1390    IF R1=1 THEN 1410
1400       PRINT "  ";STR$(R1-1);",";STR$(C1);
1410    IF C1=1 THEN 1430
1420       PRINT "  ";STR$(R1);",";STR$(C1-1);
1430    IF C1=6 THEN 1450
1440       PRINT "  ";STR$(R1);",";STR$(C1+1);
1450    IF R1=6 THEN 1470
1460       PRINT "  ";STR$(R1+1);",";STR$(C1);
1470    IF (3-R1)*(4-R1)<>0 THEN 1500   'NOT IN CENTER ROWS
1480       IF (3-C1)*(4-C1)<>0 THEN 1500   'NOT IN CENTER COLS
1490          PRINT "  ";STR$(ABS(7-R1));",";STR$(ABS(7-C1));
1500    PRINT
1510    PRINT "WANT THE COMPLETE INSTRUCTIONS"?;
1520    LINPUT IS
1530    IF SEG$(IS,1,1)="Y" THEN 1550
1540        GOTO 1280
1550    GOSUB 2320
1560    GOTO 1280
1570
1580    ' CHECK IF LEGAL MOVE
1590      
1600 IF LEN(A$)<>3 THEN 1680            'A$ MUST BE 3 CHARACTERS
1610    CHANGE A$ TO A
1620    IF A$(2)<>44 THEN 1680          'MIDDLE CHARACTER MUST BE COMMA
1630       LET R3=A$(1)-48              'R3 IS TRIAL ROW
1640       LET C3=A$(3)-48              'C3 IS TRIAL COLUMN
1650       IF (9-R3)*R3<0 THEN 1680     'R3 MUST BE A DIGIT
1660          IF (9-C3)*C3<0 THEN 1680   'C3 MUST BE A DIGIT
1670             GOTO 1710
1680 PRINT "YOU MUST TYPE 2 DIGITS SEPARATED BY A COMMA.  INPUT IGNORED."
1690  GOTO 1280
1700

