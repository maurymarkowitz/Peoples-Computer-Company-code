100 ' NAME:  ELEMLIB***:SQUARE
110 '
120 ' BY:  MAC OGLESBY ON 29 NOV 75.
130 '
140 ' DESCRIPTION:  A GAME FOR TWO PLAYERS ON A BOARD OF 25 (OR 24)
150 '   POINTS.  THE OBJECT IS TO CHOOSE POINTS TO FORM A SQUARE.
160 '
170 ' INSTRUCTIONS:  TYPE "RUN" FOR COMPLETE INSTRUCTIONS.
180 '
190 '
200 DIM S$(50),S(24,12)
210 LET A$(1)="X"
220 LET A$(2)="O"
230
240 'SET UP BOARD
250 FOR R0=0 TO 4
260    FOR C0=0 TO 4
270       LET D$(R0,C0)="."  'NORMAL BOARD HAS 25 DOTS
280    NEXT C0
290 NEXT R0
300
310 PRINT "WANT INSTRUCTIONS FOR SQUARE";
320 LINPUT A$
330 LET A$=SEG$(A$,1,1)
340 CHANGE A$ TO A
350 IF (89-A(1))*(121-A(1))=0 THEN 370
360    GOTO 510
370 LET A(1)=89
380 PRINT
390 PRINT "   THE GAME OF SQUARE IS FOR 2 PLAYERS.  THE NORMAL BOARD"
400 PRINT "LOOKS LIKE THIS AT THE START:"
410 GOSUB 1810
420 PRINT "   THE PLAYERS GO IN TURN AND CHOOSE ANY UNOCCUPIED POINT"
430 PRINT "(SHOWN AS A DOT).  EACH PLAYER HAS 12 MARKERS (X'S OR O'S)"
440 PRINT "WHICH ARE USED TO IDENTIFY CHOSEN POINTS."
450 PRINT "   THE WINNER IS THE FIRST PLAYER WHO HAS CHOSEN 4 POINTS"
460 PRINT "WHICH COULD FORM THE CORNERS OF A SQUARE."
470 PRINT "   TO CHOOSE A POINT, TYPE 2 DIGITS (0 TO 4) SEPARATED BY A"
480 PRINT "COMMA.  THE FIRST DIGIT TELLS THE DISTANCE OVER (TO THE RIGHT)"
490 PRINT "FROM POINT 0,0.  THE SECOND DIGIT TELLS THE DISTANCE UP."
500 PRINT "REMEMBER, OVER,UP."
510 PRINT
520 PRINT "1=NORMAL GAME (25 DOTS)   2=EXPERT'S GAME (NO CENTER DOT)"
530 INPUT B
540 IF (2-B)*(1-B)=0 THEN 580
550    PRINT "PLEASE TYPE 1 OR 2."
560    GOTO 520
570
580 IF B=1 THEN 620
590    LET D$(2,2)=" "                'CENTER DOT BECOMES A SPACE
600    LET N=38                       'EXPERT'S GAME HAS 38 SQUARES
610    GOTO 640
620 LET N=50                          'NORMAL GAME HAS 50 SQUARES
630
640 FOR J=0 TO 24
650    READ S(J,0)
660 NEXT J
670 'S(J,0) TELLS HOW MANY SQUARES USE EACH POINT AS A CORNER.
680    DATA 4,7,8,7,4,7,10,11,10,7,8,11,12,11,8,7,10,11,10,7,4,7,8,7,4
690
700 FOR J=0 TO 24
710    FOR K=1 TO S(J)
720       READ S(J,K)
730    NEXT K
740 NEXT J
750 'S(,) TELLS WHICH SQUARES FROM LIST S$() HAVE A CORNER AT EACH POINT.
760    DATA 1,11,35,43
770    DATA 1,2,15,20,28,31,36
780    DATA 2,3,21,24,29,43,44,47
790    DATA 3,4,16,25,30,34,35
800    DATA 4,13,36,44
810    DATA 1,5,15,24,30,32,37
820    DATA 1,2,5,14,22,25,38,39,47,48
830    DATA 2,3,15,16,17,23,26,32,33,39,40
840    DATA 3,4,6,14,20,27,37,40,47,49
850    DATA 4,6,16,21,28,33,38
860    DATA 5,7,20,26,29,43,45,48
870    DATA 5,7,15,17,1,21,27,31,34,39,41
880    DATA 39,40,41,42,43,44,45,46,47,48,49,50
890    DATA 6,8,16,17,19,22,24,31,34,40,42
900    DATA 6,8,23,25,29,44,46,49
910    DATA 7,9,18,22,28,32,35
920    DATA 7,9,10,14,23,24,36,41,45,50
930    DATA 10,11,17,18,19,20,25,32,33,41,42
940    DATA 8,11,12,14,21,26,35,42,49,50
950    DATA 8,12,19,27,30,33,36
960    DATA 9,13,37,45
970    DATA 9,10,18,26,30,34,38
980    DATA 10,11,22,27,29,45,46,50
990    DATA 11,12,19,23,28,34,37
990    DATA 11,12,19,23,28,34,37
1000   DATA 12,12,38,46
1010
1020 FOR J=1 TO N
1030    READ S$(J)
1040 NEXT J
1050 'S$() STORES THE LOCATIONS OF THE CORNERS OF ALL POSSIBLE SQUARES.
1060 'EACH GROUP OF 8 PAIRS OF DIGITS LISTS 4 CORNERS (YXYXYXYX).
1070 DATA "00011110","01021211","02031312","03041413","10112120"
1080 DATA "13142423","20213130","23243433","30314140","31324241"
1090 DATA "32334342","33344443","02244440","11133331"
1100 DATA "01133220","02143332","11234233","12244331"
1110 DATA "01133220","02143332","11234233","12244331"
1120 DATA "02233110","03243211","12334120","13344221"
1130 DATA "01144330","02244220","03344110"
1140 DATA "01032321","10123230","12143432","21234341"
1150 DATA "00033330","01043431","12134340","11144441"
1160 DATA "11122221","12132322","21223231","22233332"
1170 DATA "00022220","02042422","20224240","22244442"
1180 DATA "02132321","11223120","13243322","22334231"
1190
1200 IF A(1)<>89 THEN 1230
1205    IF B=2 THEN 1230
1210       PRINT
1220       GOTO 1250
1230 GOSUB 1810
1240
1250 LET T=T+1                        'TURN COUNTER
1260
1270 FOR J=1 TO 2                     'MAIN MOVE LOOP
1280    IF T>1 THEN 1310
1290       PRINT "THE ";A$(J);"'S CHOOSE WHICH POINT";
1300       GOTO 1320
1310    PRINT A$(j);"'S CHOICE";
1320    LINPUT A$
1330    IF LEN(A$)<>3 THEN 1640       'CHECK FOR LEGAL INPUT
1340       CHANGE AS TO A
1350       IF (52-A(1))*(A(1)-48)<0 THEN 1640
1360          IF A(2)<>44 THEN 1640
1370             IF (52-A(3))*(A(3)-48)<0 THEN 1640
1380                LET R1=A(3)-48     'R1 IS "Y" COORDINATE
1390                LET C1=A(1)-48     'C1 IS "X" COORDINATE
1400                IF D$(R1,C1)<>"." THEN 1620  'CHECK FOR LEGAL CHOICE
1410                   LET D$(R1,C1)=AS(J)  'UPDATE BOARD
1420
1430                   'CHECK FOR A SQUARE
1440                   IF T<4 THEN 1600
1450                      LET S0=5*R1+C1
1460                      FOR J1=1 TO S(S0,0)
1470                         IF B=1 THEN 1500
1480                            IF S(S0,J1)=38 THEN 1500
1490                               GOTO 1670
1500                         FOR K1=1 TO 6 STEP 2
1510                            LET D1=VAL(SEG$(S$(S(S0,J1)),K1,K1))
1520                            LET D2=VAL(SEG$(S$(S(S0,J1)),K1+1,K1+1))
1530                            IF D$(D1,D2)=A$(J) THEN 1550
1540                               GOTO 1590
1550                         NEXT K1
1560                         PRINT "*** THE ";A$(J);"'S WIN!|! ***"
1570                         GOSUB 1810  'PRINT FINAL BOARD
1580                         GOTO 1730  'GOODBYE
1590                      NEXT J1
1600                   GOTO 1670
1610
1620                PRINT "ILLEGAL CHOICE!"
1630                GOTO 1650
1640    PRINT "YOU MUST TYPE 2 DIGITS (FROM 0 TO 4) SEPARATED BY A COMMA."
1650    PRINT "INPUT IGNORED.  PLEASE TRY AGAIN..."
1660    GOTO 1310
1670 NEXT J
1680
1690 IF T>12 THEN 1760                '12 TURN LIMIT
1700    PRINT
1710    PRINT "THIS GAME IS A DRAW, FOR NEITHER PLAYER MADE A SQUARE!"
1720    GOSUB 1810                    'PRINT FINAL BOARD
1730    PRINT "TYPE  RUN  TO PLAY AGAIN."
1740    STOP
1750
1760 GOSUB 1810                       'PRINT BOARD
1770
1780 GOTO 1250                        'GO GET NEXT CHOICES
1790
1800 'PRINT THE BOARD
1810 PRINT
1820 FOR R0=4 TO 0 STEP-1
1830    PRINT STR$(R0);" ";
1840    FOR C0=0 TO 4
1850       PRINT D$(R0,C0);
1860          IF C0=4 THEN 1880
1870             PRINT "    ";
1880     NEXT C0
1890     PRINT
1900     IF R0=0 THEN 1930
1910        PRINT
1920        PRINT
1930 NEXT R0
1940 PRINT "   0    1     2     3     4"
1950 PRINT
1960 RETURN
1970
1980 END